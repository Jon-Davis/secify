syntax = "proto3";

package secify;

message EncryptionHeader {
  uint32 version = 1;
  string encryption_algorithm = 2;
  KeyDerivationConfig kdf = 3;
  bytes salt = 4;
  bytes nonce = 5;
  uint32 chunk_size = 6;
  optional CompressionConfig compression = 7;
  optional string archive = 8;
}

message KeyDerivationConfig {
  string algorithm = 1;
  string version = 2;
  uint32 memory_cost = 3;
  uint32 time_cost = 4;
  uint32 parallelism = 5;
  uint32 output_length = 6;
}

message CompressionConfig {
  string algorithm = 1;
  int32 level = 2;
}
